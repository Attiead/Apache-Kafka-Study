# 카프카 미러메이커2
- 서로 다른 2개의 클러스터 간 토픽을 복제하는 애플리케이션
- 왜?
    - 직접 프로듀서와 컨슈머를 사용하여 미러링하는 앱을 만들어도 된다.
    - 이유인 즉슨, 토픽의 모든 것을 복제할 필요성이 있다.
    - 직접 구현하면 어렵다.
        - 동일 파티션 동일 레코드가 저장되는 것은 복제 전 클러스터에서 사용하는 파티셔너에 대한 정보 없이 불가능함.
    - 이래서 사용한다.

<br>

<img src ="https://user-images.githubusercontent.com/89288109/230383784-14a6f649-e6ab-4289-aabd-05fec6f3fd5a.png">

<br>

## 미러메이커2를 이용한 단방향 토픽 복제
- config 디렉토리에 포함된 **connect-mirrot-maker.properties** 파일 수정

<br>

## 미러메이커2를 활용한 지리적 복제 (Geo-Replication)
- 미러메이커2를 활용하면, 카프카 클러스터 단위의 활용도 up!
- 단방향, 양방향 복제, ACL 복제, 새 토픽 자동 감지 기능은 **클러스터가 2개!** 이상일 때 빛을 발함.

<bR>

### Active-Standby 클러스터 운영 방식
- 직접 서비스 앱과 통신하는 카프카 클러스터 외에 재해 복구를 위해 임시 클러스터를 하나 더 구성할 경우
- 이 전략을 통하여, 예상치 못한 장애에 대응 가능!

<br>

<img src="https://user-images.githubusercontent.com/89288109/230384631-f6b3e3fe-4719-49d5-9df6-ff266bfbeb46.png">

<br>

### Active-Active 클러스터 운영 방식
- 글로벌 서비스 운영 시, 앱 간 통신 지연을 최소화하기 위해 최소 2개 이상 클러스터를 운영 후 서로 데이터를 미러링
- 서로 다른 지역에서 사용하고, 각 클러스터 간 필요한 데이터만 복제하여 사용하는 방법이 있다.
- 각 지역에 필요한 데이터만 조회하므로, 데이터의 지연을 줄일 수 있다.

<br>

<img src="https://user-images.githubusercontent.com/89288109/230385360-7014aa9d-6cf3-4261-b9ae-8206019de0db.png">

<Br>

### Hub and Spoke 클러스터 운영 방식
- 각 팀에서 소규모 카프카 클러스터를 사용 시, 각 팀의 데이터를 한 개의 클러스터에 모아 Data Lake 로서 사용할 경우
- 허브 = 중앙에 있는 한 점
- 스포크 = 다른 점들을 연결한 선
- 이 전략은 서비스에서 생성된 데이터를 수집, 가공, 분석하는 격리된 플랫폼이 필요하다.
    - 이 때, 미러메이커2를 사용하여 각 팀의 클러스터에 존재하는 데이터를 수집하고, 데이터 레이크 클러스터에서 가공 및 분석을 통해 필요한 데이터를 찾을 수 있다.
- 필요할 경우 양방향 토픽 복제도 가능하며, 데이터 조합도 당연히 가능~

<br>

<img src= "https://user-images.githubusercontent.com/89288109/230386011-20cb5a20-6786-4180-9d98-aee6000f0b39.png">